name: model-wine-quality
on: [push]
jobs:
    run:
        runs-on: [self-hosted]
        steps:
            - uses: actions/setup-node@v2
              with:
              node-version: '16'
      # - uses: actions/setup-python@v2
      #   with:
      #     python-version: '3.x'
            - uses: iterative/setup-cml@v1
            - uses: actions/checkout@v3
            - name: cml_run
              env:
                repo_token: ${{ secrets.GITHUB_TOKEN }}
              run: |
              
                # Your ML workflow goes here
                pip install -r requirements.txt
                python train.py
              
                echo "## MODEL METRICS " > report.md
                cat metrics.txt >> report.md
                
                echo "## Data viz " >> report.md
                cml-publish feature_importance.png --md >> report.md
                cml-publish residuals.png --md >> report.md
                
                cml-send-comment report.md
